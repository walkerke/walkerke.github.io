<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>Mapping religious adherence in the US with CartoDB  &middot; Kyle Walker</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="CartoDB, R, ">


<meta property="og:title" content="Mapping religious adherence in the US with CartoDB  &middot; Kyle Walker ">
<meta property="og:site_name" content="Kyle Walker"/>
<meta property="og:url" content="/2015/02/mapping-religious-adherence-in-the-us-with-cartodb/" />
<meta property="og:locale" content="en-us">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2015-02-26T00:00:00Z" />
<meta property="og:article:modified_time" content="2015-02-26T00:00:00Z" />

  
    
<meta property="og:article:tag" content="CartoDB">
    
<meta property="og:article:tag" content="R">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@kyle_e_walker" />
<meta name="twitter:creator" content="@kyle_e_walker" />
<meta name="twitter:title" content="Mapping religious adherence in the US with CartoDB" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="/2015/02/mapping-religious-adherence-in-the-us-with-cartodb/" />
<meta name="twitter:domain" content="/">
  

<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "Article",
    "headline": "Mapping religious adherence in the US with CartoDB",
    "author": {
      "@type": "Person",
      "name": "http://profiles.google.com/+?rel=author"
    },
    "datePublished": "2015-02-26",
    "description": "",
    "wordCount":  1171 
  }
</script>



<link rel="canonical" href="../../../2015/02/mapping-religious-adherence-in-the-us-with-cartodb/" />

<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../../../touch-icon-144-precomposed.png">
<link href="../../../favicon.png" rel="icon">

<meta name="generator" content="Hugo 0.17" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<link href='https://fonts.googleapis.com/css?family=Merriweather:300%7CRaleway%7COpen+Sans' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="../../../css/font-awesome.min.css">
<link rel="stylesheet" href="../../../css/style.css">
<link rel="stylesheet" href="../../../css/highlight/zenburn.css">

  <!DOCTYPE HTML>
<style>
  
  .main_wrapper>.main_header {
    background-color: #035004;
    color: #fff;
  }
  
  .main_wrapper>.main_content .label:hover,
  .main_wrapper>.main_content .navigation a:hover,
  .main_wrapper>.main_content .pagination a:hover,
  .main_wrapper>.main_content .readlink a:hover,
  .main_wrapper>.main_content h2 a:hover,
  .main_wrapper>.main_header a:hover {
    background-color: #035004;
    color: #fff;
    text-decoration: none; 
}

  a {
    color: #1a730f; 
  }
  
  a:active, a:focus, a:hover {
    color: #035004;
}
  
</style>

</head>
<body class="map[name:superhero]">
  <main id="main-wrapper" class="container main_wrapper has-sidebar">
    <header id="main-header" class="container main_header">
  <div class="container brand">
  <div class="container title h1-like">
  <a class="baselink" href="../../../">
  Kyle Walker

</a>

</div>

  
<div class="container topline">
  
  Writing about visualization, demographics, dashboards, and spatial data science. <br/><br/>Interested in learning more?  Hire me for a workshop or to consult on your next project.  See the Services page for more details.


</div>


</div>

  <nav class="container nav primary no-print">
  


  
<a href="../../../about">About</a>

<a href="../../../post" title="Show list of posts">Posts</a>

<a href="../../../tags" title="Show list of tags">Tags</a>

<a href="../../../services">Services</a>

<a href="https://www.r-bloggers.com/">R-Bloggers</a>


</nav>

<div class="container nav secondary no-print">
  
<a id="contact-link-email" class="contact_link" href="mailto:kwalkerdata@gmail.com">
  <span class="fa fa-envelope-square"></span><span>email</span></a>



<a id="contact-link-github" class="contact_link" href="https://github.com/walkerke">
  <span class="fa fa-github-square"></span><span>github</span></a>





<a id="contact-link-linkedin" class="contact_link" href="https://www.linkedin.com/in/walkerke">
  <span class="fa fa-linkedin-square"></span><span>linkedin</span></a>







<a id="contact-link-twitter" class="contact_link" href="https://twitter.com/kyle_e_walker">
  <span class="fa fa-twitter-square"></span><span>twitter</span></a>













</div>


  

</header>


<article id="main-content" class="container main_content single">
  <header class="container hat">
  <h1>Mapping religious adherence in the US with CartoDB
</h1>

  <div class="metas">
<time datetime="2015-02-26">26 Feb, 2015</time>


  
    &middot; by Kyle Walker
  
  &middot; Read in about 6 min
  &middot; (1171 Words)
  <br>
  
<a class="label" href="../../../tags/cartodb">CartoDB</a>

<a class="label" href="../../../tags/r">R</a>



</div>

</header>

  <div class="container content">
  <p>Before coming to TCU, I worked as a data analyst for the <a href="https://www.cpg.org/">Church Pension Group</a>, which manages the retirement funds and provides other financial services for the Episcopal Church.  I was part of a small research group that completed both internal and public-facing studies using the company&rsquo;s data.  <a href="https://www.cpg.org/global/research/reports-statistics/">You can take a look at some of the studies I worked on here</a>.  While I was at CPG, I developed an interest in the sociology of religion, as changing rates of religious adherence were of critical importance to CPG&rsquo;s work, as they impact the overall viability of parishes (and in turn the fiscal health of the Church).  During this time, data for the <a href="http://www.rcms2010.org/">2010 US Religion Census (or Religious Congregations and Membership Study, abbreviated as RCMS)</a> started to become available.  As the US Census does not ask questions about religion, researchers interested in studying religion must turn to other data sources like these.</p>

<p>I never had the opportunity to really dig into this dataset while at CPG, as I left for my current position at TCU shortly afterward.  However, as I teach about the geography of religious adherence (defined here as the proportion of the population actively practicing a religion) in my World Regional Geography course, I took the opportunity to dive back into the data.  I was inspired by <a href="http://www.glenmary.org/rcms2010/">this map from the Glenmary Research Center</a> which maps the top religious family by county in the United States.  This map is excellent, but I wanted an interactive version that I could explore with my students in class (and that they could explore outside of class).  However, I did really like the bivariate cartographic technique they used to present the data (<a href="http://www.joshuastevens.net/cartography/make-a-bivariate-choropleth-map/">see this post from Joshua Stevens for a great overview of bivariate mapping</a>).  In this instance, the top religious group in each county is assigned a color; then, the intensity of the color is related to the adherence percentage for that group.  This makes sense; if two counties have Catholic as their top group, but one has an adherence of 75 percent as opposed to 20 percent for the other, they should not be represented the same way.</p>

<p>There are many other examples of this type of cartographic approach.  Some excellent examples have come from <a href="https://twitter.com/SR_spatial">Steven Romalewski</a> and CUNY&rsquo;s Center for Urban Research, where they have mapped <a href="http://www.urbanresearchmaps.org/comparinator/pluralitymap.htm">demographic change</a> and <a href="http://www.electionatlas.nyc/maps.html#!interactive">election results</a>.  I use the demographic map in my teaching every semester to discuss issues of gentrification and demographic inversion in metropolitan areas.  In the CUNY maps, the qualitative color of a feature represents the most prevalent group (e.g. race) and then the intensity of the hue represents its relative value (the percentage represented by that racial group).</p>

<p>A related approach is <strong>value-by-alpha</strong>, which works in a similar way in that the color of a feature represents one attribute, and its opacity represents an equalizing attribute, like total population.  You can read more about <a href="https://twitter.com/awoodruff">Andy Woodruff&rsquo;s</a> fine work on the topic <a href="http://andywoodruff.com/blog/how-to-make-a-value-by-alpha-map/">here</a>, <a href="http://andywoodruff.com/blog/value-by-alpha-maps/">here</a>, and <a href="http://www.ncbi.nlm.nih.gov/pmc/articles/PMC3173776/">here</a>.</p>

<p>I borrow from these approaches to map religious adherence by county using <a href="http://cartodb.com/">CartoDB</a>, a phenomenal web-based platform for creating interactive maps.  CartoDB&rsquo;s functionality ranges from the creation of simple maps with a user-friendly web UI to actual GIS functionality using its PostGIS backend with spatial SQL.  Here is the map I created; below, I&rsquo;ll explain how I did it!  Use the arrows button in the upper left to pop the map out to full screen; <a href="http://kwalkertcu.cartodb.com/viz/dfe2d3b2-a0da-11e4-a315-0e4fddd5de28/embed_map">click here if you&rsquo;d like a direct link to the map.</a></p>

<iframe width='100%' height='600' frameborder='0' src='http://kwalkertcu.cartodb.com/viz/dfe2d3b2-a0da-11e4-a315-0e4fddd5de28/embed_map' allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen></iframe>

<p>The map shows the top religious adherence group by county, with some key differences from the Glenmary map; I classified the data as Catholic, Evangelical Protestant, Latter-Day Saints (Mormon), Mainline Protestant, and Black Protestant.  No other major category was the top group in the lower 48 states plus DC.  I used R to process the data; I won&rsquo;t go into detail about that here, but you can <a href="https://github.com/walkerke/teaching-with-datavis/blob/master/religion/religion2.R">view the code in my GitHub repository</a>.  The whole process can be reproduced by <a href="https://github.com/walkerke/teaching-with-datavis/tree/master/religion">cloning the repo</a>, running the script, and zipping up the new shapefile <code>cty_religion</code> for uploading to CartoDB.</p>

<p>Uploading your data to CartoDB is straightforward: once your data are in the right format (in this instance, in the form of a zipped shapefile), just sign in and drag and drop!  Once your data have loaded, CartoDB includes a number of &ldquo;wizards&rdquo; you can use to style your data in a very user-friendly way.  For more complex visualizations, however, you can use <a href="https://www.mapbox.com/tilemill/docs/manual/carto/">CartoCSS</a>.  CartoCSS, which is also used by MapBox Studio (another new favorite of mine), is a CSS-like syntax for styling map data.  It also makes bivariate visualizations possible.  To style the map, I grabbed some colors from <a href="http://colorbrewer2.org/">ColorBrewer</a> and used the following syntax:</p>

<pre><code class="language-css">#cty_religion {
   line-color: #FFF;
   line-width: 1;
   line-opacity: 1;
}

#cty_religion[religion=&quot;Evangelical&quot;] {
   polygon-fill: #e41a1c;
}
#cty_religion[religion=&quot;Catholic&quot;] {
   polygon-fill: #377eb8;
}
#cty_religion[religion=&quot;Mainline&quot;] {
   polygon-fill: #4daf4a;
}
#cty_religion[religion=&quot;LDS&quot;] {
   polygon-fill: #984ea3;
}
#cty_religion[religion=&quot;African-American&quot;] {
   polygon-fill: #ff7f00;
}

#cty_religion[percent &gt;= 0] {
  polygon-opacity: 0.2; 
}
#cty_religion[percent &gt;= 20] {
  polygon-opacity: 0.4;
}
#cty_religion[percent &gt;= 30] {
  polygon-opacity: 0.6;
}
#cty_religion[percent &gt;= 40] {
  polygon-opacity: 0.8;
}
</code></pre>

<p>The <code>polygon-fill</code> method is used to style my data by religious category with colors; the <code>polygon-opacity</code> method then adjusts the opacity of the features, which then blend with the light-gray CartoDB basemap to show relative intensity.  I used, roughly, a quantile classification scheme with four bins (with some slight rounding to 20, 30, and 40) for this.  The map, I feel, shows clear trends in religious adherence in the US.  The South is the Evangelical center of the country; Catholicism is more prevalent along the US/Mexico border and in the Northeast, Utah is a Mormon stronghold, and Mainline Protestantism predominates in the Upper Midwest.   The bivariate approach also gives the viewer a sense of the relative religiosity of different places; whereas Utah and the Southeast appear to have much stronger adherence to their top religious groups, the opacity of features in the Northwest suggests lower religiosity there (or at least no group that is significant numbers-wise).</p>

<p>There is a lot more I&rsquo;d like to do with this map; here are some ideas:</p>

<ul>
<li>I&rsquo;ve restricted this to the lower 48 states plus DC; Alaska and Hawaii should be added.<br /></li>
<li>I&rsquo;d like a better legend that shows variation in intensity as well as hue; I experimented with this a little but couldn&rsquo;t quite get anything satisfactory working.<br /></li>
<li>It would be great to have an interactive chart appear upon clicking each county that shows the overall distribution of each group; this is beyond my current CartoDB.js skills but something to consider for a future iteration.<br /></li>
</ul>

<p>If you have any comments or questions, please let me know!</p>

<p><strong>Thanks to:</strong></p>

<ul>
<li>Steven Romalewski and the CUNY Center for Urban Research for their innovative approaches to bivariate mapping</li>
<li>Andy Woodruff and others for resources on the value-by-alpha technique</li>
<li>CartoDB</li>
<li>The <a href="http://www.thearda.com/">Association of Religion Data Archives</a> for providing free access to the RCMS data</li>
<li><a href="http://www.nhgis.org">NHGIS</a> at the University of Minnesota for the spatial data</li>
<li>The Glenmary Research Center for inspiring this map</li>
</ul>

</div>


  <footer class="container">
  <div class="container navigation no-print">
  <h2>Navigation</h2>
  
  

    
    <a class="prev" href="../../../2014/12/charting-time-series-data-with-dygraphs-in-r-and-python/" title="Charting time series data with dygraphs in R and Python">
      Previous
    </a>
    

    
    <a class="next" href="../../../2015/03/custom_tiles/" title="Using custom tiles in an RStudio Leaflet map">
      Next
    </a>
    

  


</div>

  

</footer>

</article>
      <footer id="main-footer" class="container main_footer">
  

  <div class="container nav foot no-print">
  

  <a class="toplink" href="#">back to top</a>

</div>

  <div class="container credits">
  
<div class="container footline">
  

</div>


  
<div class="container copyright">
  
  &copy; 2016 Kyle Walker


</div>


</div>

</footer>

    </main>
    
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//your_disqus_shortname.disqus.com/count.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>



<script src="../../../js/highlight.pack.js"></script>
<script>hljs.initHighlightingOnLoad();</script>



<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51388803-1', 'auto');
  ga('send', 'pageview');

</script>


    
  </body>
</html>

